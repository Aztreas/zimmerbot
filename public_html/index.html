<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
        <title>Wikimedia Tools Labs - ZimmerBot</title>
        <link rel="stylesheet" href="assets/css/foundation.css" />
        <script src="assets/js/vendor/modernizr.js"></script>
    </head>
    <body>

        <div class="grid-container">

            <h2>ZimmerBot</h2>
            <hr>
            <p>
                Welcome to the home page of ZimmerBot, a tool created and maintained by DiversaTech at Berkeley since Fall 2017!
            </p>
            <p>
                To learn more about this project, please visit <a href="https://meta.wikimedia.org/wiki/New_Readers/Offline/Content_curation" target="blank"> this link</a>.
            </p>

            <br>

            <h3>Generate Links</h3>
            <hr>
            <div class="grid-x grid-padding-x">
                <!-- Search -->
                <div class = "small-12 large-6 columns">
                    <fieldset class="fieldset">
                        <legend>Search</legend>

                        <!--Search Method-->
                        <div class="grid-x grid-padding-x">
                            <div class="small-4 cell">
                                <label for="method" class="text-right middle">
                                    <span data-tooltip aria-haspopup="true" class="has-tip top" data-click-open="true" data-disable-hover="false" tabindex="2" title="Sort search results based on a certain criterion">
                                        Method:
                                    </span>
                                </label>
                            </div>
                            <div class="small-6 cell">
                                <select id="method">
                                    <option value="individual">Individual Articles</option>
                                    <option value="category">*Coming Soon* Categories</option>
                                    <option value="related">*Coming Soon* Collections of Related Articles</option>
                                    <option value="linked">*Coming Soon* Collections of Linked Articles</option>
                                </select>
                            </div>
                        </div>

                        <!-- Language -->
                        <div class="grid-x grid-padding-x">
                            <div class="small-4 cell">
                                <label for="language" class="text-right middle">
                                    <span data-tooltip aria-haspopup="true" class="has-tip top" data-click-open="true" data-disable-hover="false" tabindex="2" title="Search by language">
                                        Language:
                                    </span>
                                </label>
                            </div>
                            <div class="small-6 cell">
                                <select id="language">
                                    <option value="english">English</option>
                                    <option value="russian">Russian</option>
                                    <option value="french">French</option>
                                </select>
                            </div>
                        </div>

                        <!-- Search Query (Keywords) -->
                        <div class="grid-x grid-padding-x">
                            <div class="small-4 cell">
                                <label for="query" class="text-right middle">
                                    <span data-tooltip aria-haspopup="true" class="has-tip top" data-click-open="true" data-disable-hover="false" tabindex="2" title="Place an input of your desired search terms">
                                        Query:
                                    </span>
                                </label>
                            </div>
                            <div class="small-6 cell">
                                <input type="text" id="query" placeholder="Keywords"/>
                            </div>
                        </div>

                    </fieldset>
                </div>

                <!-- Filter & Limit -->
                <div class = "small-12 large-6 columns">
                    <fieldset class="fieldset" style="height: 245;">
                        <legend>Filter & Limit</legend>

                        <!-- Filter Method -->
                        <div class="grid-x grid-padding-x">
                            <div class="small-4 cell">
                                <label for="filter" class="text-right middle">
                                        <span data-tooltip aria-haspopup="true" class="has-tip top" data-click-open="true" data-disable-hover="false" tabindex="2"
                                         title="Article Score - filters by Article Score.
                                        Popularity - filters by popularity score.
                                        Quality - filters by ORES assessment
                                        Most Linked To - filters by most relevant urls
                                        Exclude Stubs - filters out stub articles">
                                            Filter By:
                                        </span>
                                </label>
                            </div>
                            <div class="small-6 cell">
                                <select id="filter">
                                    <!-- <option value="score">Article Score</option> -->
                                    <option value="popularity">Popularity</option>
                                    <option value="ores_quality">Quality</option>
                                    <option value="most_linked_to">Most Linked To</option>
                                </select>
                            </div>
                        </div>

                        <!-- Limit Method -->
                        <div class="grid-x grid-padding-x">
                            <div class="small-4 cell">
                                <label for="limit_method" class="text-right middle">
                                        <span data-tooltip aria-haspopup="true" class="has-tip top" data-click-open="true" data-disable-hover="false" tabindex="2" title="Filter by megabytes or number of articles">
                                            Limit By:
                                        </span>
                                </label>
                            </div>
                            <div class="small-6 cell">
                                <select id="limit-chooser">
                                    <option value="number">Number of Articles</option>
                                    <option value="size">Size (in MB)</option>
                                    <option value="none">None</option>
                                </select>
                            </div>
                        </div>

                        <!-- Limit -->
                        <div class="grid-x grid-padding-x">
                            <div class="small-4 cell">
                                <label for="limit" class="text-right middle">
                                        <span data-tooltip aria-haspopup="true" class="has-tip top" data-click-open="true" data-disable-hover="false" tabindex="2" title="Specify number of megabytes or articles to limit by">
                                            Limit:
                                        </span>
                                </label>
                            </div>
                            <div class="small-6 cell">
                                <input type="number" id="limit" placeholder="MB or #"/>
                            </div>
                        </div>

                    </fieldset>
                </div>
            </div>

            <!-- Additional Options -->
            <fieldset class="fieldset">
                <legend>Additional Options</legend>

                <div class="grid-x grid-padding-x">
                    <!-- Media Options -->
                    <div class="small-4 large-2 cell">
                        <label for="media-type" class="text-right middle">Media:</label>
                    </div>
                    <div class="small-8 large-3 cell">
                        <select id="media">
                            <option value="text_only">Text Only</option>
                            <option value="text_and_images">Text and Images Only</option>
                            <option value="all">Text and All Media</option>
                        </select>
                    </div>

                    <!-- Stubs -->
                    <div class="small-4 large-3 cell">
                        <label for="media-type" class="text-right middle">Stubs:</label>
                    </div>
                    <div class="small-8 large-3 cell">
                        <select id="stub">
                            <option value="include">Include</option>
                            <option value="exclude">Exclude</option>
                        </select>
                    </div>
                </div>

            </fieldset>

            <!-- Submit Button -->
            <div class="grid-x grid-padding-x">
                <div class="small-12 large-2 large-offset-5 cell">
                    <button type="button" id="submit" class="button expanded">Submit</button>
                </div>
            </div>

            <!-- Message -->
            <p id="message" align="center"></p>

            <!-- Search Results -->
            <fieldset class="fieldset">
                <legend>Search Results</legend>
                <textarea id="results" placeholder="No links yet" rows="3"></textarea>
            </fieldset>

            <!-- Result Handling Buttons -->
            <div class="grid-x grid-padding-x">
                <div class="small-12 large-6 large-offset-3 cell">
                    <div class="stacked-for-small button-group">
                        <button id="download" type="button" class="success button">Download Link Collection</button>
                        <button id="clear" type="button" class="alert button">Clear Results</button>
                    </div>
                </div>
            </div>

            <h3>Project Team Members</h3>
            <hr>
            <div class="grid-x grid-padding-x small-up-2 large-up-3">
                <div class="cell"><li> Jihoon An </li></div>
                <div class="cell"><li> Sean Lee </li></div>
                <div class="cell"><li> Leon Ming </li></div>
                <div class="cell"><li> Jimmy Tsang </li></div>
                <div class="cell"><li> Neil Palleti </li></div>
                <div class="cell"><li> Celena Chang </li></div>
                <div class="cell"><li> Jade Yen </li></div>
                <div class="cell"><li> Cynthia Ha </li></div>
                <div class="cell"><li> Tiffany Pham </li></div>
                <div class="cell"><li> Hannah Kim </li></div>
                <div class="cell"><li> Vishnu Kumar </li></div>
            </div>
            <hr>
            <br>
        </div>

        <script src="assets/js/vendor/jquery.js"></script>
        <script src="assets/js/foundation.min.js"></script>
        <script>
            $(document).foundation();
        </script>
        <script>
            $("#submit").click(function() {
                $("#message").html("Please wait, this may take a while...");
                var xhr = new XMLHttpRequest();
                var url = "https://zimmerbot-env.u27bjsbm6e.us-west-2.elasticbeanstalk.com/";
                xhr.open("POST", url, true);
                xhr.setRequestHeader("Content-type", "application/json");
                xhr.onreadystatechange = function () {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        var json = JSON.parse(xhr.responseText);
                        console.log(json);
                        $("#results").html(json.join("\n"));
                        $("#message").html("");
                    } else {
                        $("#message").html("Something went wrong, please try something else");
                    }
                };
                var request = JSON.stringify(
                    {
                        "query" : $("#query").val(),
                        "language" : $("#language").val(),
                        "filter" : $("#filter").val(),
                        "limit" : $("#limit").val()
                    }
                );
                console.log(request);
                xhr.send(request);
            });

            $("#download").click(function(){
                $("#results").select();
                document.execCommand('copy');
            });

            $("#clear").click(function(){
                $("#results").val("");
            });
        </script>
    </body>
</html>
